2021-12-03 21:46:13,272 - root - INFO - Namespace(K=10, O1_print_every=1, O2_print_every=1, O3_print_every=1, O4_print_every=1, auto_encoder_dim=9, batch_size=32, circle_size=500, city_name='Nanjing', data_dir='datasets/', enterprise=['Starbucks', "Dunkin'", "McDonald's"], eps=1e-09, evaluate_every=1, gamma=8, grid_size_latitude_degree=0.005, grid_size_longitude_degree=0.005, lambda_1=1, lambda_2=0.5, lambda_3=0.5, lambda_4=0.025, lr=0.001, mess_dropout=0.1, n_epoch=10, print_every=100, save_dir='trained_model/Nanjing/source_area_coordinate118.739776-118.814792-32.055803-32.100893_target_area_coordinate118.739776-118.814792-32.055803-32.100893/', score_norm_max=400, seed=981125, source_area_coordinate=[118.739776, 118.814792, 32.055803, 32.100893], stopping_steps=10, target_area_coordinate=[118.729991, 118.808783, 32.011709, 32.055803], target_enterprise="Dunkin'")
2021-12-03 21:46:13,272 - root - INFO - --------------parse args and init done.
2021-12-03 21:46:15,677 - root - INFO - [2 /10]       check enterprise and get small category set.
2021-12-03 21:46:15,678 - root - INFO - n_source_grid: 3481, n_target_grid: 8712
2021-12-03 21:46:15,678 - root - INFO - [3 /10]       split grid done.
2021-12-03 21:46:34,593 - root - INFO - [4 /10]       distribute data into grids done.
2021-12-03 21:46:34,606 - root - INFO - [5 /10]       generate rating matrix for Transfer Rating Prediction Model done.
2021-12-03 21:46:35,521 - root - INFO - [6 /10]       extract geographic features done.
2021-12-03 21:46:35,866 - root - INFO - [7 /10]       extract commercial features done.
2021-12-03 21:46:35,878 - root - INFO - [8 /10]       combine features done.
2021-12-03 21:46:52,109 - root - INFO - [9 /10]       get PCCS and generate delta set done.
2021-12-03 21:46:52,121 - root - INFO - [10/10]       generate training and testing index done.
2021-12-03 21:46:52,198 - root - INFO - --------------load data done.
2021-12-03 21:46:52,208 - root - INFO - CityTransfer(
  (auto_encoder): ModuleList(
    (0): denoising_model(
      (encoder): Sequential(
        (0): Linear(in_features=31, out_features=256, bias=True)
        (1): ReLU(inplace=True)
        (2): Linear(in_features=256, out_features=128, bias=True)
        (3): ReLU(inplace=True)
        (4): Linear(in_features=128, out_features=64, bias=True)
        (5): ReLU(inplace=True)
      )
      (decoder): Sequential(
        (0): Linear(in_features=64, out_features=128, bias=True)
        (1): ReLU(inplace=True)
        (2): Linear(in_features=128, out_features=256, bias=True)
        (3): ReLU(inplace=True)
        (4): Linear(in_features=256, out_features=31, bias=True)
        (5): Sigmoid()
      )
    )
    (1): denoising_model(
      (encoder): Sequential(
        (0): Linear(in_features=31, out_features=256, bias=True)
        (1): ReLU(inplace=True)
        (2): Linear(in_features=256, out_features=128, bias=True)
        (3): ReLU(inplace=True)
        (4): Linear(in_features=128, out_features=64, bias=True)
        (5): ReLU(inplace=True)
      )
      (decoder): Sequential(
        (0): Linear(in_features=64, out_features=128, bias=True)
        (1): ReLU(inplace=True)
        (2): Linear(in_features=128, out_features=256, bias=True)
        (3): ReLU(inplace=True)
        (4): Linear(in_features=256, out_features=31, bias=True)
        (5): Sigmoid()
      )
    )
  )
)
2021-12-03 21:46:52,210 - root - INFO - --------------construct model and optimizer done.
2021-12-03 21:46:52,210 - root - INFO - --------------initialize metrics done.
2021-12-03 21:46:52,210 - root - INFO - [!]-----------start training.
